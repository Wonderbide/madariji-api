# ===================================================================
# PRODUCTION PROFILE CONFIGURATION
# ===================================================================
# Activate with: SPRING_PROFILES_ACTIVE=production
# ALL secrets and IDs MUST come from environment variables (Doppler/Railway)

# ===================================================================
# SERVER CONFIGURATION
# ===================================================================
server.port=${PORT:8080}
server.address=0.0.0.0
server.forward-headers-strategy=native
server.tomcat.remoteip.remote-ip-header=x-forwarded-for
server.tomcat.remoteip.protocol-header=x-forwarded-proto

# ===================================================================
# DATABASE (from Railway DATABASE_URL)
# ===================================================================
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false

# Disable Liquibase for fresh production deployment
# Hibernate will create schema from entities
spring.liquibase.enabled=false

# ===================================================================
# LOGGING (production level)
# ===================================================================
logging.level.root=INFO
logging.level.com.backcover=WARN
logging.level.org.springframework.security=WARN
logging.pattern.console=%d{HH:mm:ss} %-5level %logger{0} - %msg%n

# ===================================================================
# ERROR HANDLING (no sensitive info exposed)
# ===================================================================
server.error.include-stacktrace=never
server.error.include-message=never

# ===================================================================
# HEALTH CHECKS (Railway probes)
# ===================================================================
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true
management.endpoint.health.show-details=always
management.health.db.enabled=true
management.health.diskspace.enabled=true
management.endpoints.web.exposure.include=health,info

# ===================================================================
# MEMORY OPTIMIZATION (Railway containers)
# ===================================================================
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2
server.tomcat.threads.max=50
server.tomcat.threads.min-spare=5
spring.jpa.properties.hibernate.jdbc.batch_size=5
spring.cache.type=none

# ===================================================================
# DEV TOOLS (disabled)
# ===================================================================
spring.devtools.restart.enabled=false

# ===================================================================
# SENTRY ERROR MONITORING
# ===================================================================
sentry.dsn=${SENTRY_DSN:}
sentry.environment=production
sentry.traces-sample-rate=0.0
sentry.send-default-pii=false
sentry.logging.minimum-event-level=error
sentry.logging.minimum-breadcrumb-level=warn
